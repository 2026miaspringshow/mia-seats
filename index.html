<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 MIA SPRING SHOW | ç¥¨å‹™ç®¡ç†ç³»çµ±</title>
    <style>
        :root { 
            --primary-blue: rgb(94, 121, 172); 
            --accent-blue: #2196f3; 
            --bg-gray: #f8f9fa; 
            --sold-pink: rgb(216, 83, 123); 
            --camera-gray: #616161;
            --mia-gradient: linear-gradient(135deg, #e91e63 0%, #673ab7 100%);
            --confirm-dark: #0d1b2a;
        }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background-color: var(--bg-gray); margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* 1. æ¨™é¡Œå€å¡Šå¼·åŒ– */
        .header { background: var(--mia-gradient); color: white; padding: 12px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.2); z-index: 1000; }
        .header-title-wrapper { display: flex; align-items: center; gap: 12px; }
        .header-logo { height: 48px; width: auto; object-fit: contain; } 
        .header-title h1 { margin: 0; font-size: 18px; font-weight: 800; letter-spacing: 1.5px; line-height: 1.2; } /* ä¸»æ¨™åŠ ç²— */
        .header-title span { font-size: 13px; font-weight: 400; opacity: 0.95; } /* å‰¯æ¨™åŠ å¤§ */
        
        .menu-btn { background: none; border: none; color: white; font-size: 26px; cursor: pointer; }
        .side-menu { position: fixed; top: 0; right: -250px; width: 250px; height: 100%; background: white; box-shadow: -5px 0 15px rgba(0,0,0,0.1); transition: 0.3s; z-index: 2000; padding-top: 60px; }
        .side-menu.active { right: 0; }
        .menu-item { padding: 15px 25px; border-bottom: 1px solid #eee; color: #333; cursor: pointer; display: flex; align-items: center; gap: 10px; font-weight: bold; }
        .menu-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; z-index: 1500; }

        .main-content { flex: 1; overflow-y: auto; padding-bottom: 120px; display: flex; flex-direction: column; align-items: center; }
        .legend-area { display: flex; gap: 12px; margin: 15px 0; font-size: 11px; color: #666; justify-content: center; flex-wrap: wrap; }
        .legend-item { display: flex; align-items: center; gap: 4px; }
        .legend-box { width: 14px; height: 14px; border-radius: 3px; border: 1px solid #ddd; }

        /* 3. åº§ä½å€ä½ˆå±€å°é½Šä¿®æ­£ */
        .venue-wrapper { width: 100%; overflow-x: auto; padding: 10px 0; }
        .stage-area { width: fit-content; margin: 0 auto; display: flex; flex-direction: column; align-items: center; padding: 0 50px; }
        .screen { background: #121212; width: 400px; margin-bottom: 40px; padding: 10px; color: #fff; border-radius: 0 0 80px 80px; text-align: center; font-size: 13px; letter-spacing: 5px; }
        
        .venue-container { display: grid; grid-template-columns: auto auto auto; gap: 50px; width: fit-content; }
        .block { display: flex; flex-direction: column; gap: 6px; }
        #LT, #LM, #LB { align-items: flex-end; }
        #RT, #RM, #RB { align-items: flex-start; }
        #MT, #MM, #MB { align-items: center; }
        .row { display: flex; gap: 4px; height: 32px; align-items: center; }
        
        .seat { width: 34px; height: 34px; font-size: 10px; border-radius: 5px; display: flex; align-items: center; justify-content: center; border: 1px solid #e0e0e0; background: white; cursor: pointer; transition: 0.1s; }
        .sold { background-color: var(--sold-pink) !important; color: white !important; border: none; }
        .selected { background-color: var(--primary-blue) !important; color: white !important; }
        .camera-seat { background: var(--camera-gray) !important; border: none; color: white; cursor: default; }
        .pr-seat { border: 1px solid #ffca28 !important; background-color: #fffde7; }

        /* 4. åº•éƒ¨è³‡è¨Šæ¢æ”¹ç‰ˆ */
        .bottom-bar { position: fixed; bottom: 0; left: 0; right: 0; height: 100px; background: white; display: none; align-items: center; justify-content: center; gap: 60px; padding: 0 40px; box-shadow: 0 -5px 20px rgba(0,0,0,0.1); z-index: 100; border-top: 1px solid #eee; }
        .logged-in .bottom-bar { display: flex; }

        .price-info { text-align: left; line-height: 1.4; }
        .price-row-top { font-size: 12px; color: #999; margin-bottom: 2px; }
        .price-row-middle { font-size: 24px; font-weight: 800; color: var(--primary-blue); }
        .price-row-bottom { font-size: 12px; color: #aaa; }

        .btn-confirm-main { 
            background: var(--confirm-dark); 
            color: white; 
            padding: 16px 45px; 
            border-radius: 50px; 
            border: none; 
            font-size: 16px; 
            font-weight: bold; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            box-shadow: 0 4px 15px rgba(13, 27, 42, 0.3);
            transition: 0.3s;
        }
        .btn-confirm-main:disabled { background: #e0e0e0; color: #bbb; box-shadow: none; cursor: not-allowed; }
        .btn-confirm-main svg { width: 22px; height: 22px; fill: white; }
        .btn-confirm-main:disabled svg { fill: #bbb; }

        /* å½ˆçª—æ¨£å¼ */
        .modal-overlay { position: fixed; top:0; left:0; right:0; bottom:0; background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 3000; padding: 15px; }
        .modal { background: white; width: 100%; max-width: 400px; border-radius: 15px; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.3); }
        .modal-header { background: var(--mia-gradient); color: white; padding: 18px; text-align: center; font-size: 18px; font-weight: bold; position: relative; }
        .close-x { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer; font-size: 24px; }
        .modal-body { padding: 25px; }

        .form-group { margin-bottom: 12px; }
        .form-group label { display: block; font-size: 12px; font-weight: bold; margin-bottom: 4px; color: #666; }
        .form-group input, .form-group select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 14px; }

        .total-row { display: flex; justify-content: space-between; align-items: center; margin: 15px 0; border-top: 1px dashed #ddd; padding-top: 15px; }
        .total-amount { font-size: 28px; font-weight: bold; color: var(--accent-blue); }
        .btn-confirm-final { background: var(--confirm-dark); color: white; width: 100%; padding: 16px; border-radius: 10px; border: none; font-size: 16px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body id="main-body">

    <div class="header">
        <div class="header-title-wrapper">
            <img src="logo.png" class="header-logo" alt="MIA LOGO" onerror="this.style.display='none'">
            <div class="header-title">
                <h1>2026 8th MIA SPRING SHOW</h1>
                <span>å³æ™‚åº§ä½ç¥¨å‹™ç³»çµ±</span>
            </div>
        </div>
        <button class="menu-btn" onclick="toggleMenu()">â˜°</button>
    </div>

    <div class="menu-overlay" id="menu-overlay" onclick="toggleMenu()"></div>
    <div class="side-menu" id="side-menu">
        <div class="menu-item" id="menu-login" onclick="handleLogin()">ğŸ”’ ç®¡ç†å“¡ç™»å…¥</div>
        <div class="menu-item" id="menu-logout" onclick="handleLogout()" style="display:none;">ğŸ”“ ç®¡ç†å“¡ç™»å‡º</div>
        <div class="menu-item" onclick="exportData()">ğŸ“¥ åŒ¯å‡ºè³¼ç¥¨åå†Š</div>
    </div>

    <div class="main-content">
        <div class="legend-area">
            <div class="legend-item"><div class="legend-box" style="background:white;"></div> å¯é¸ä½</div>
            <div class="legend-item"><div class="legend-box" style="background:var(--primary-blue);"></div> å·²é¸æ“‡</div>
            <div class="legend-item"><div class="legend-box" style="background:var(--sold-pink);"></div> å·²å”®å‡º</div>
            <div class="legend-item"><div class="legend-box" style="background:var(--camera-gray);"></div> æ”å½±å¸­</div>
            <div class="legend-item"><div class="legend-box" style="background:#fffde7; border-color:#ffca28;"></div> ä¿ç•™å¸­</div>
        </div>

        <div class="venue-wrapper">
            <div class="stage-area">
                <div class="screen">STAGE èˆ å°</div>
                <div class="venue-container" id="grid">
                    <div id="LT" class="block"></div><div id="MT" class="block"></div><div id="RT" class="block"></div>
                    <div id="LM" class="block"></div><div id="MM" class="block"></div><div id="RM" class="block"></div>
                    <div id="LB" class="block"></div><div id="MB" class="block"></div><div id="RB" class="block"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="bottom-bar">
        <div class="price-info">
            <div class="price-row-top">ç¸½è¨ˆé‡‘é¡</div>
            <div id="display-total" class="price-row-middle">NT$ 0</div>
            <div id="display-sub-info" class="price-row-bottom">æ—©é³¥ç¥¨åƒ¹ NT$ 600 / å¼µ | å·²é¸ 0 å¼µ</div>
        </div>
        <button class="btn-confirm-main" id="btn-open-modal" disabled>
            <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
            ç¢ºèªè³¼ç¥¨
        </button>
    </div>

    <div class="modal-overlay" id="modal-purchase">
        <div class="modal">
            <div class="modal-header">
                åŠƒä½ç¢ºèª
                <span class="close-x" onclick="closeModal('modal-purchase')">Ã—</span>
            </div>
            <div class="modal-body">
                <div class="form-group"><label>åŠƒä½åº§ä½</label><input type="text" id="buy-seat-list" readonly style="background:#f5f5f5; border:none; font-weight:bold; color:var(--primary-blue);"></div>
                <div class="form-group">
                    <label>ç¥¨åƒ¹é¡å‹</label>
                    <select id="p-type" onchange="calculateFinalTotal()">
                        <option value="600">æ—©é³¥ç¥¨
